import numpy as np

from src.data.preprocessing.frequent_motif import find_repeat_subseqs, encode_node_types
from src.data.preprocessing.utils import (
    remove_useless_node,
    GraphAdj,
    remove_loose_input
)
from src.data.utils import visualize_graph


def test():
    # graph_edges = [('stem.INPUT-0', 'stem.conv_3x3'), ('stem.conv_3x3', 'stem.bn'),
    #                ('stem.bn', 'layer-0.dil_conv_3x3-0'), ('stem.bn', 'layer-0.sep_conv_3x3-0'),
    #                ('stem.bn', 'layer-0.avg_pool_3x3-0'), ('stem.bn', 'layer-0.avg_pool_3x3-2'),
    #                ('stem.bn', 'layer-0.sep_conv_3x3-1'), ('layer-0.avg_pool_3x3-0', 'layer-0.ADD-0'),
    #                ('layer-0.dil_conv_3x3-0', 'layer-0.ADD-0'), ('layer-0.ADD-0', 'layer-0.avg_pool_3x3-1'),
    #                ('layer-0.ADD-0', 'layer-0.CONCAT-0'), ('layer-0.avg_pool_3x3-1', 'layer-0.ADD-1'),
    #                ('layer-0.avg_pool_3x3-2', 'layer-0.ADD-1'), ('layer-0.ADD-1', 'layer-0.avg_pool_3x3-3'),
    #                ('layer-0.ADD-1', 'layer-0.CONCAT-0'), ('layer-0.sep_conv_3x3-0', 'layer-0.ADD-2'),
    #                ('layer-0.avg_pool_3x3-3', 'layer-0.ADD-2'), ('layer-0.ADD-2', 'layer-0.avg_pool_3x3-4'),
    #                ('layer-0.ADD-2', 'layer-0.CONCAT-0'), ('layer-0.sep_conv_3x3-1', 'layer-0.ADD-3'),
    #                ('layer-0.avg_pool_3x3-4', 'layer-0.ADD-3'), ('layer-0.ADD-3', 'layer-0.CONCAT-0'),
    #                ('stem.bn', 'layer-1.dil_conv_3x3-0'), ('stem.bn', 'layer-1.sep_conv_3x3-0'),
    #                ('layer-0.CONCAT-0', 'layer-1.avg_pool_3x3-0'), ('layer-0.CONCAT-0', 'layer-1.avg_pool_3x3-2'),
    #                ('layer-0.CONCAT-0', 'layer-1.sep_conv_3x3-1'), ('layer-1.avg_pool_3x3-0', 'layer-1.ADD-0'),
    #                ('layer-1.dil_conv_3x3-0', 'layer-1.ADD-0'), ('layer-1.ADD-0', 'layer-1.avg_pool_3x3-1'),
    #                ('layer-1.ADD-0', 'layer-1.CONCAT-0'), ('layer-1.avg_pool_3x3-1', 'layer-1.ADD-1'),
    #                ('layer-1.avg_pool_3x3-2', 'layer-1.ADD-1'), ('layer-1.ADD-1', 'layer-1.avg_pool_3x3-3'),
    #                ('layer-1.ADD-1', 'layer-1.CONCAT-0'), ('layer-1.sep_conv_3x3-0', 'layer-1.ADD-2'),
    #                ('layer-1.avg_pool_3x3-3', 'layer-1.ADD-2'), ('layer-1.ADD-2', 'layer-1.avg_pool_3x3-4'),
    #                ('layer-1.ADD-2', 'layer-1.CONCAT-0'), ('layer-1.sep_conv_3x3-1', 'layer-1.ADD-3'),
    #                ('layer-1.avg_pool_3x3-4', 'layer-1.ADD-3'), ('layer-1.ADD-3', 'layer-1.CONCAT-0'),
    #                ('layer-0.CONCAT-0', 'layer-2.dil_conv_3x3-0'), ('layer-0.CONCAT-0', 'layer-2.sep_conv_3x3-0'),
    #                ('layer-1.CONCAT-0', 'layer-2.avg_pool_3x3-0'), ('layer-1.CONCAT-0', 'layer-2.avg_pool_3x3-2'),
    #                ('layer-1.CONCAT-0', 'layer-2.sep_conv_3x3-1'), ('layer-2.avg_pool_3x3-0', 'layer-2.ADD-0'),
    #                ('layer-2.dil_conv_3x3-0', 'layer-2.ADD-0'), ('layer-2.ADD-0', 'layer-2.avg_pool_3x3-1'),
    #                ('layer-2.ADD-0', 'layer-2.CONCAT-0'), ('layer-2.avg_pool_3x3-1', 'layer-2.ADD-1'),
    #                ('layer-2.avg_pool_3x3-2', 'layer-2.ADD-1'), ('layer-2.ADD-1', 'layer-2.avg_pool_3x3-3'),
    #                ('layer-2.ADD-1', 'layer-2.CONCAT-0'), ('layer-2.sep_conv_3x3-0', 'layer-2.ADD-2'),
    #                ('layer-2.avg_pool_3x3-3', 'layer-2.ADD-2'), ('layer-2.ADD-2', 'layer-2.avg_pool_3x3-4'),
    #                ('layer-2.ADD-2', 'layer-2.CONCAT-0'), ('layer-2.sep_conv_3x3-1', 'layer-2.ADD-3'),
    #                ('layer-2.avg_pool_3x3-4', 'layer-2.ADD-3'), ('layer-2.ADD-3', 'layer-2.CONCAT-0'),
    #                ('layer-1.CONCAT-0', 'layer-3.dil_conv_3x3-0'), ('layer-1.CONCAT-0', 'layer-3.sep_conv_3x3-0'),
    #                ('layer-2.CONCAT-0', 'layer-3.avg_pool_3x3-0'), ('layer-2.CONCAT-0', 'layer-3.avg_pool_3x3-2'),
    #                ('layer-2.CONCAT-0', 'layer-3.sep_conv_3x3-1'), ('layer-3.avg_pool_3x3-0', 'layer-3.ADD-0'),
    #                ('layer-3.dil_conv_3x3-0', 'layer-3.ADD-0'), ('layer-3.ADD-0', 'layer-3.avg_pool_3x3-1'),
    #                ('layer-3.ADD-0', 'layer-3.CONCAT-0'), ('layer-3.avg_pool_3x3-1', 'layer-3.ADD-1'),
    #                ('layer-3.avg_pool_3x3-2', 'layer-3.ADD-1'), ('layer-3.ADD-1', 'layer-3.avg_pool_3x3-3'),
    #                ('layer-3.ADD-1', 'layer-3.CONCAT-0'), ('layer-3.sep_conv_3x3-0', 'layer-3.ADD-2'),
    #                ('layer-3.avg_pool_3x3-3', 'layer-3.ADD-2'), ('layer-3.ADD-2', 'layer-3.avg_pool_3x3-4'),
    #                ('layer-3.ADD-2', 'layer-3.CONCAT-0'), ('layer-3.sep_conv_3x3-1', 'layer-3.ADD-3'),
    #                ('layer-3.avg_pool_3x3-4', 'layer-3.ADD-3'), ('layer-3.ADD-3', 'layer-3.CONCAT-0'),
    #                ('layer-2.CONCAT-0', 'layer-4.dil_conv_3x3-0'), ('layer-2.CONCAT-0', 'layer-4.sep_conv_3x3-0'),
    #                ('layer-3.CONCAT-0', 'layer-4.avg_pool_3x3-0'), ('layer-3.CONCAT-0', 'layer-4.avg_pool_3x3-2'),
    #                ('layer-3.CONCAT-0', 'layer-4.sep_conv_3x3-1'), ('layer-4.avg_pool_3x3-0', 'layer-4.ADD-0'),
    #                ('layer-4.dil_conv_3x3-0', 'layer-4.ADD-0'), ('layer-4.ADD-0', 'layer-4.avg_pool_3x3-1'),
    #                ('layer-4.ADD-0', 'layer-4.CONCAT-0'), ('layer-4.avg_pool_3x3-1', 'layer-4.ADD-1'),
    #                ('layer-4.avg_pool_3x3-2', 'layer-4.ADD-1'), ('layer-4.ADD-1', 'layer-4.avg_pool_3x3-3'),
    #                ('layer-4.ADD-1', 'layer-4.CONCAT-0'), ('layer-4.sep_conv_3x3-0', 'layer-4.ADD-2'),
    #                ('layer-4.avg_pool_3x3-3', 'layer-4.ADD-2'), ('layer-4.ADD-2', 'layer-4.avg_pool_3x3-4'),
    #                ('layer-4.ADD-2', 'layer-4.CONCAT-0'), ('layer-4.sep_conv_3x3-1', 'layer-4.ADD-3'),
    #                ('layer-4.avg_pool_3x3-4', 'layer-4.ADD-3'), ('layer-4.ADD-3', 'layer-4.CONCAT-0'),
    #                ('layer-3.CONCAT-0', 'layer-5.dil_conv_3x3-0'), ('layer-3.CONCAT-0', 'layer-5.sep_conv_3x3-0'),
    #                ('layer-4.CONCAT-0', 'layer-5.avg_pool_3x3-0'), ('layer-4.CONCAT-0', 'layer-5.avg_pool_3x3-2'),
    #                ('layer-4.CONCAT-0', 'layer-5.sep_conv_3x3-1'), ('layer-5.avg_pool_3x3-0', 'layer-5.ADD-0'),
    #                ('layer-5.dil_conv_3x3-0', 'layer-5.ADD-0'), ('layer-5.ADD-0', 'layer-5.avg_pool_3x3-1'),
    #                ('layer-5.ADD-0', 'layer-5.CONCAT-0'), ('layer-5.avg_pool_3x3-1', 'layer-5.ADD-1'),
    #                ('layer-5.avg_pool_3x3-2', 'layer-5.ADD-1'), ('layer-5.ADD-1', 'layer-5.avg_pool_3x3-3'),
    #                ('layer-5.ADD-1', 'layer-5.CONCAT-0'), ('layer-5.sep_conv_3x3-0', 'layer-5.ADD-2'),
    #                ('layer-5.avg_pool_3x3-3', 'layer-5.ADD-2'), ('layer-5.ADD-2', 'layer-5.avg_pool_3x3-4'),
    #                ('layer-5.ADD-2', 'layer-5.CONCAT-0'), ('layer-5.sep_conv_3x3-1', 'layer-5.ADD-3'),
    #                ('layer-5.avg_pool_3x3-4', 'layer-5.ADD-3'), ('layer-5.ADD-3', 'layer-5.CONCAT-0'),
    #                ('layer-4.CONCAT-0', 'layer-6.dil_conv_5x5-0'), ('layer-4.CONCAT-0', 'layer-6.sep_conv_5x5-0'),
    #                ('layer-5.CONCAT-0', 'layer-6.skip_connect-0'), ('layer-5.CONCAT-0', 'layer-6.dil_conv_3x3-0'),
    #                ('layer-5.CONCAT-0', 'layer-6.dil_conv_5x5-1'), ('layer-6.skip_connect-0', 'layer-6.ADD-0'),
    #                ('layer-6.dil_conv_5x5-0', 'layer-6.ADD-0'), ('layer-6.ADD-0', 'layer-6.skip_connect-1'),
    #                ('layer-6.ADD-0', 'layer-6.sep_conv_3x3-0'), ('layer-6.ADD-0', 'layer-6.CONCAT-0'),
    #                ('layer-6.dil_conv_3x3-0', 'layer-6.ADD-1'), ('layer-6.skip_connect-1', 'layer-6.ADD-1'),
    #                ('layer-6.ADD-1', 'layer-6.avg_pool_3x3-0'), ('layer-6.ADD-1', 'layer-6.CONCAT-0'),
    #                ('layer-6.avg_pool_3x3-0', 'layer-6.ADD-2'), ('layer-6.sep_conv_3x3-0', 'layer-6.ADD-2'),
    #                ('layer-6.ADD-2', 'layer-6.CONCAT-0'), ('layer-6.sep_conv_5x5-0', 'layer-6.ADD-3'),
    #                ('layer-6.dil_conv_5x5-1', 'layer-6.ADD-3'), ('layer-6.ADD-3', 'layer-6.CONCAT-0'),
    #                ('layer-5.CONCAT-0', 'layer-7.dil_conv_3x3-0'), ('layer-5.CONCAT-0', 'layer-7.sep_conv_3x3-0'),
    #                ('layer-6.CONCAT-0', 'layer-7.avg_pool_3x3-0'), ('layer-6.CONCAT-0', 'layer-7.avg_pool_3x3-2'),
    #                ('layer-6.CONCAT-0', 'layer-7.sep_conv_3x3-1'), ('layer-7.avg_pool_3x3-0', 'layer-7.ADD-0'),
    #                ('layer-7.dil_conv_3x3-0', 'layer-7.ADD-0'), ('layer-7.ADD-0', 'layer-7.avg_pool_3x3-1'),
    #                ('layer-7.ADD-0', 'layer-7.CONCAT-0'), ('layer-7.avg_pool_3x3-1', 'layer-7.ADD-1'),
    #                ('layer-7.avg_pool_3x3-2', 'layer-7.ADD-1'), ('layer-7.ADD-1', 'layer-7.avg_pool_3x3-3'),
    #                ('layer-7.ADD-1', 'layer-7.CONCAT-0'), ('layer-7.sep_conv_3x3-0', 'layer-7.ADD-2'),
    #                ('layer-7.avg_pool_3x3-3', 'layer-7.ADD-2'), ('layer-7.ADD-2', 'layer-7.avg_pool_3x3-4'),
    #                ('layer-7.ADD-2', 'layer-7.CONCAT-0'), ('layer-7.sep_conv_3x3-1', 'layer-7.ADD-3'),
    #                ('layer-7.avg_pool_3x3-4', 'layer-7.ADD-3'), ('layer-7.ADD-3', 'layer-7.CONCAT-0'),
    #                ('layer-6.CONCAT-0', 'layer-8.dil_conv_3x3-0'), ('layer-6.CONCAT-0', 'layer-8.sep_conv_3x3-0'),
    #                ('layer-7.CONCAT-0', 'layer-8.avg_pool_3x3-0'), ('layer-7.CONCAT-0', 'layer-8.avg_pool_3x3-2'),
    #                ('layer-7.CONCAT-0', 'layer-8.sep_conv_3x3-1'), ('layer-8.avg_pool_3x3-0', 'layer-8.ADD-0'),
    #                ('layer-8.dil_conv_3x3-0', 'layer-8.ADD-0'), ('layer-8.ADD-0', 'layer-8.avg_pool_3x3-1'),
    #                ('layer-8.ADD-0', 'layer-8.CONCAT-0'), ('layer-8.avg_pool_3x3-1', 'layer-8.ADD-1'),
    #                ('layer-8.avg_pool_3x3-2', 'layer-8.ADD-1'), ('layer-8.ADD-1', 'layer-8.avg_pool_3x3-3'),
    #                ('layer-8.ADD-1', 'layer-8.CONCAT-0'), ('layer-8.sep_conv_3x3-0', 'layer-8.ADD-2'),
    #                ('layer-8.avg_pool_3x3-3', 'layer-8.ADD-2'), ('layer-8.ADD-2', 'layer-8.avg_pool_3x3-4'),
    #                ('layer-8.ADD-2', 'layer-8.CONCAT-0'), ('layer-8.sep_conv_3x3-1', 'layer-8.ADD-3'),
    #                ('layer-8.avg_pool_3x3-4', 'layer-8.ADD-3'), ('layer-8.ADD-3', 'layer-8.CONCAT-0'),
    #                ('layer-7.CONCAT-0', 'layer-9.dil_conv_3x3-0'), ('layer-7.CONCAT-0', 'layer-9.sep_conv_3x3-0'),
    #                ('layer-8.CONCAT-0', 'layer-9.avg_pool_3x3-0'), ('layer-8.CONCAT-0', 'layer-9.avg_pool_3x3-2'),
    #                ('layer-8.CONCAT-0', 'layer-9.sep_conv_3x3-1'), ('layer-9.avg_pool_3x3-0', 'layer-9.ADD-0'),
    #                ('layer-9.dil_conv_3x3-0', 'layer-9.ADD-0'), ('layer-9.ADD-0', 'layer-9.avg_pool_3x3-1'),
    #                ('layer-9.ADD-0', 'layer-9.CONCAT-0'), ('layer-9.avg_pool_3x3-1', 'layer-9.ADD-1'),
    #                ('layer-9.avg_pool_3x3-2', 'layer-9.ADD-1'), ('layer-9.ADD-1', 'layer-9.avg_pool_3x3-3'),
    #                ('layer-9.ADD-1', 'layer-9.CONCAT-0'), ('layer-9.sep_conv_3x3-0', 'layer-9.ADD-2'),
    #                ('layer-9.avg_pool_3x3-3', 'layer-9.ADD-2'), ('layer-9.ADD-2', 'layer-9.avg_pool_3x3-4'),
    #                ('layer-9.ADD-2', 'layer-9.CONCAT-0'), ('layer-9.sep_conv_3x3-1', 'layer-9.ADD-3'),
    #                ('layer-9.avg_pool_3x3-4', 'layer-9.ADD-3'), ('layer-9.ADD-3', 'layer-9.CONCAT-0'),
    #                ('layer-8.CONCAT-0', 'layer-10.dil_conv_3x3-0'), ('layer-8.CONCAT-0', 'layer-10.sep_conv_3x3-0'),
    #                ('layer-9.CONCAT-0', 'layer-10.avg_pool_3x3-0'), ('layer-9.CONCAT-0', 'layer-10.avg_pool_3x3-2'),
    #                ('layer-9.CONCAT-0', 'layer-10.sep_conv_3x3-1'), ('layer-10.avg_pool_3x3-0', 'layer-10.ADD-0'),
    #                ('layer-10.dil_conv_3x3-0', 'layer-10.ADD-0'), ('layer-10.ADD-0', 'layer-10.avg_pool_3x3-1'),
    #                ('layer-10.ADD-0', 'layer-10.CONCAT-0'), ('layer-10.avg_pool_3x3-1', 'layer-10.ADD-1'),
    #                ('layer-10.avg_pool_3x3-2', 'layer-10.ADD-1'), ('layer-10.ADD-1', 'layer-10.avg_pool_3x3-3'),
    #                ('layer-10.ADD-1', 'layer-10.CONCAT-0'), ('layer-10.sep_conv_3x3-0', 'layer-10.ADD-2'),
    #                ('layer-10.avg_pool_3x3-3', 'layer-10.ADD-2'), ('layer-10.ADD-2', 'layer-10.avg_pool_3x3-4'),
    #                ('layer-10.ADD-2', 'layer-10.CONCAT-0'), ('layer-10.sep_conv_3x3-1', 'layer-10.ADD-3'),
    #                ('layer-10.avg_pool_3x3-4', 'layer-10.ADD-3'), ('layer-10.ADD-3', 'layer-10.CONCAT-0'),
    #                ('layer-9.CONCAT-0', 'layer-11.dil_conv_3x3-0'), ('layer-9.CONCAT-0', 'layer-11.sep_conv_3x3-0'),
    #                ('layer-10.CONCAT-0', 'layer-11.avg_pool_3x3-0'), ('layer-10.CONCAT-0', 'layer-11.avg_pool_3x3-2'),
    #                ('layer-10.CONCAT-0', 'layer-11.sep_conv_3x3-1'), ('layer-11.avg_pool_3x3-0', 'layer-11.ADD-0'),
    #                ('layer-11.dil_conv_3x3-0', 'layer-11.ADD-0'), ('layer-11.ADD-0', 'layer-11.avg_pool_3x3-1'),
    #                ('layer-11.ADD-0', 'layer-11.CONCAT-0'), ('layer-11.avg_pool_3x3-1', 'layer-11.ADD-1'),
    #                ('layer-11.avg_pool_3x3-2', 'layer-11.ADD-1'), ('layer-11.ADD-1', 'layer-11.avg_pool_3x3-3'),
    #                ('layer-11.ADD-1', 'layer-11.CONCAT-0'), ('layer-11.sep_conv_3x3-0', 'layer-11.ADD-2'),
    #                ('layer-11.avg_pool_3x3-3', 'layer-11.ADD-2'), ('layer-11.ADD-2', 'layer-11.avg_pool_3x3-4'),
    #                ('layer-11.ADD-2', 'layer-11.CONCAT-0'), ('layer-11.sep_conv_3x3-1', 'layer-11.ADD-3'),
    #                ('layer-11.avg_pool_3x3-4', 'layer-11.ADD-3'), ('layer-11.ADD-3', 'layer-11.CONCAT-0'),
    #                ('layer-10.CONCAT-0', 'layer-12.dil_conv_3x3-0'), ('layer-10.CONCAT-0', 'layer-12.sep_conv_3x3-0'),
    #                ('layer-11.CONCAT-0', 'layer-12.avg_pool_3x3-0'), ('layer-11.CONCAT-0', 'layer-12.avg_pool_3x3-2'),
    #                ('layer-11.CONCAT-0', 'layer-12.sep_conv_3x3-1'), ('layer-12.avg_pool_3x3-0', 'layer-12.ADD-0'),
    #                ('layer-12.dil_conv_3x3-0', 'layer-12.ADD-0'), ('layer-12.ADD-0', 'layer-12.avg_pool_3x3-1'),
    #                ('layer-12.ADD-0', 'layer-12.CONCAT-0'), ('layer-12.avg_pool_3x3-1', 'layer-12.ADD-1'),
    #                ('layer-12.avg_pool_3x3-2', 'layer-12.ADD-1'), ('layer-12.ADD-1', 'layer-12.avg_pool_3x3-3'),
    #                ('layer-12.ADD-1', 'layer-12.CONCAT-0'), ('layer-12.sep_conv_3x3-0', 'layer-12.ADD-2'),
    #                ('layer-12.avg_pool_3x3-3', 'layer-12.ADD-2'), ('layer-12.ADD-2', 'layer-12.avg_pool_3x3-4'),
    #                ('layer-12.ADD-2', 'layer-12.CONCAT-0'), ('layer-12.sep_conv_3x3-1', 'layer-12.ADD-3'),
    #                ('layer-12.avg_pool_3x3-4', 'layer-12.ADD-3'), ('layer-12.ADD-3', 'layer-12.CONCAT-0'),
    #                ('layer-11.CONCAT-0', 'layer-13.dil_conv_5x5-0'), ('layer-11.CONCAT-0', 'layer-13.sep_conv_5x5-0'),
    #                ('layer-12.CONCAT-0', 'layer-13.skip_connect-0'), ('layer-12.CONCAT-0', 'layer-13.dil_conv_3x3-0'),
    #                ('layer-12.CONCAT-0', 'layer-13.dil_conv_5x5-1'), ('layer-13.skip_connect-0', 'layer-13.ADD-0'),
    #                ('layer-13.dil_conv_5x5-0', 'layer-13.ADD-0'), ('layer-13.ADD-0', 'layer-13.skip_connect-1'),
    #                ('layer-13.ADD-0', 'layer-13.sep_conv_3x3-0'), ('layer-13.ADD-0', 'layer-13.CONCAT-0'),
    #                ('layer-13.dil_conv_3x3-0', 'layer-13.ADD-1'), ('layer-13.skip_connect-1', 'layer-13.ADD-1'),
    #                ('layer-13.ADD-1', 'layer-13.avg_pool_3x3-0'), ('layer-13.ADD-1', 'layer-13.CONCAT-0'),
    #                ('layer-13.avg_pool_3x3-0', 'layer-13.ADD-2'), ('layer-13.sep_conv_3x3-0', 'layer-13.ADD-2'),
    #                ('layer-13.ADD-2', 'layer-13.CONCAT-0'), ('layer-13.sep_conv_5x5-0', 'layer-13.ADD-3'),
    #                ('layer-13.dil_conv_5x5-1', 'layer-13.ADD-3'), ('layer-13.ADD-3', 'layer-13.CONCAT-0'),
    #                ('layer-12.CONCAT-0', 'layer-14.dil_conv_3x3-0'), ('layer-12.CONCAT-0', 'layer-14.sep_conv_3x3-0'),
    #                ('layer-13.CONCAT-0', 'layer-14.avg_pool_3x3-0'), ('layer-13.CONCAT-0', 'layer-14.avg_pool_3x3-2'),
    #                ('layer-13.CONCAT-0', 'layer-14.sep_conv_3x3-1'), ('layer-14.avg_pool_3x3-0', 'layer-14.ADD-0'),
    #                ('layer-14.dil_conv_3x3-0', 'layer-14.ADD-0'), ('layer-14.ADD-0', 'layer-14.avg_pool_3x3-1'),
    #                ('layer-14.ADD-0', 'layer-14.CONCAT-0'), ('layer-14.avg_pool_3x3-1', 'layer-14.ADD-1'),
    #                ('layer-14.avg_pool_3x3-2', 'layer-14.ADD-1'), ('layer-14.ADD-1', 'layer-14.avg_pool_3x3-3'),
    #                ('layer-14.ADD-1', 'layer-14.CONCAT-0'), ('layer-14.sep_conv_3x3-0', 'layer-14.ADD-2'),
    #                ('layer-14.avg_pool_3x3-3', 'layer-14.ADD-2'), ('layer-14.ADD-2', 'layer-14.avg_pool_3x3-4'),
    #                ('layer-14.ADD-2', 'layer-14.CONCAT-0'), ('layer-14.sep_conv_3x3-1', 'layer-14.ADD-3'),
    #                ('layer-14.avg_pool_3x3-4', 'layer-14.ADD-3'), ('layer-14.ADD-3', 'layer-14.CONCAT-0'),
    #                ('layer-13.CONCAT-0', 'layer-15.dil_conv_3x3-0'), ('layer-13.CONCAT-0', 'layer-15.sep_conv_3x3-0'),
    #                ('layer-14.CONCAT-0', 'layer-15.avg_pool_3x3-0'), ('layer-14.CONCAT-0', 'layer-15.avg_pool_3x3-2'),
    #                ('layer-14.CONCAT-0', 'layer-15.sep_conv_3x3-1'), ('layer-15.avg_pool_3x3-0', 'layer-15.ADD-0'),
    #                ('layer-15.dil_conv_3x3-0', 'layer-15.ADD-0'), ('layer-15.ADD-0', 'layer-15.avg_pool_3x3-1'),
    #                ('layer-15.ADD-0', 'layer-15.CONCAT-0'), ('layer-15.avg_pool_3x3-1', 'layer-15.ADD-1'),
    #                ('layer-15.avg_pool_3x3-2', 'layer-15.ADD-1'), ('layer-15.ADD-1', 'layer-15.avg_pool_3x3-3'),
    #                ('layer-15.ADD-1', 'layer-15.CONCAT-0'), ('layer-15.sep_conv_3x3-0', 'layer-15.ADD-2'),
    #                ('layer-15.avg_pool_3x3-3', 'layer-15.ADD-2'), ('layer-15.ADD-2', 'layer-15.avg_pool_3x3-4'),
    #                ('layer-15.ADD-2', 'layer-15.CONCAT-0'), ('layer-15.sep_conv_3x3-1', 'layer-15.ADD-3'),
    #                ('layer-15.avg_pool_3x3-4', 'layer-15.ADD-3'), ('layer-15.ADD-3', 'layer-15.CONCAT-0'),
    #                ('layer-14.CONCAT-0', 'layer-16.dil_conv_3x3-0'), ('layer-14.CONCAT-0', 'layer-16.sep_conv_3x3-0'),
    #                ('layer-15.CONCAT-0', 'layer-16.avg_pool_3x3-0'), ('layer-15.CONCAT-0', 'layer-16.avg_pool_3x3-2'),
    #                ('layer-15.CONCAT-0', 'layer-16.sep_conv_3x3-1'), ('layer-16.avg_pool_3x3-0', 'layer-16.ADD-0'),
    #                ('layer-16.dil_conv_3x3-0', 'layer-16.ADD-0'), ('layer-16.ADD-0', 'layer-16.avg_pool_3x3-1'),
    #                ('layer-16.ADD-0', 'layer-16.CONCAT-0'), ('layer-16.avg_pool_3x3-1', 'layer-16.ADD-1'),
    #                ('layer-16.avg_pool_3x3-2', 'layer-16.ADD-1'), ('layer-16.ADD-1', 'layer-16.avg_pool_3x3-3'),
    #                ('layer-16.ADD-1', 'layer-16.CONCAT-0'), ('layer-16.sep_conv_3x3-0', 'layer-16.ADD-2'),
    #                ('layer-16.avg_pool_3x3-3', 'layer-16.ADD-2'), ('layer-16.ADD-2', 'layer-16.avg_pool_3x3-4'),
    #                ('layer-16.ADD-2', 'layer-16.CONCAT-0'), ('layer-16.sep_conv_3x3-1', 'layer-16.ADD-3'),
    #                ('layer-16.avg_pool_3x3-4', 'layer-16.ADD-3'), ('layer-16.ADD-3', 'layer-16.CONCAT-0'),
    #                ('layer-15.CONCAT-0', 'layer-17.dil_conv_3x3-0'), ('layer-15.CONCAT-0', 'layer-17.sep_conv_3x3-0'),
    #                ('layer-16.CONCAT-0', 'layer-17.avg_pool_3x3-0'), ('layer-16.CONCAT-0', 'layer-17.avg_pool_3x3-2'),
    #                ('layer-16.CONCAT-0', 'layer-17.sep_conv_3x3-1'), ('layer-17.avg_pool_3x3-0', 'layer-17.ADD-0'),
    #                ('layer-17.dil_conv_3x3-0', 'layer-17.ADD-0'), ('layer-17.ADD-0', 'layer-17.avg_pool_3x3-1'),
    #                ('layer-17.ADD-0', 'layer-17.CONCAT-0'), ('layer-17.avg_pool_3x3-1', 'layer-17.ADD-1'),
    #                ('layer-17.avg_pool_3x3-2', 'layer-17.ADD-1'), ('layer-17.ADD-1', 'layer-17.avg_pool_3x3-3'),
    #                ('layer-17.ADD-1', 'layer-17.CONCAT-0'), ('layer-17.sep_conv_3x3-0', 'layer-17.ADD-2'),
    #                ('layer-17.avg_pool_3x3-3', 'layer-17.ADD-2'), ('layer-17.ADD-2', 'layer-17.avg_pool_3x3-4'),
    #                ('layer-17.ADD-2', 'layer-17.CONCAT-0'), ('layer-17.sep_conv_3x3-1', 'layer-17.ADD-3'),
    #                ('layer-17.avg_pool_3x3-4', 'layer-17.ADD-3'), ('layer-17.ADD-3', 'layer-17.CONCAT-0'),
    #                ('layer-16.CONCAT-0', 'layer-18.dil_conv_3x3-0'), ('layer-16.CONCAT-0', 'layer-18.sep_conv_3x3-0'),
    #                ('layer-17.CONCAT-0', 'layer-18.avg_pool_3x3-0'), ('layer-17.CONCAT-0', 'layer-18.avg_pool_3x3-2'),
    #                ('layer-17.CONCAT-0', 'layer-18.sep_conv_3x3-1'), ('layer-18.avg_pool_3x3-0', 'layer-18.ADD-0'),
    #                ('layer-18.dil_conv_3x3-0', 'layer-18.ADD-0'), ('layer-18.ADD-0', 'layer-18.avg_pool_3x3-1'),
    #                ('layer-18.ADD-0', 'layer-18.CONCAT-0'), ('layer-18.avg_pool_3x3-1', 'layer-18.ADD-1'),
    #                ('layer-18.avg_pool_3x3-2', 'layer-18.ADD-1'), ('layer-18.ADD-1', 'layer-18.avg_pool_3x3-3'),
    #                ('layer-18.ADD-1', 'layer-18.CONCAT-0'), ('layer-18.sep_conv_3x3-0', 'layer-18.ADD-2'),
    #                ('layer-18.avg_pool_3x3-3', 'layer-18.ADD-2'), ('layer-18.ADD-2', 'layer-18.avg_pool_3x3-4'),
    #                ('layer-18.ADD-2', 'layer-18.CONCAT-0'), ('layer-18.sep_conv_3x3-1', 'layer-18.ADD-3'),
    #                ('layer-18.avg_pool_3x3-4', 'layer-18.ADD-3'), ('layer-18.ADD-3', 'layer-18.CONCAT-0'),
    #                ('layer-17.CONCAT-0', 'layer-19.dil_conv_3x3-0'), ('layer-17.CONCAT-0', 'layer-19.sep_conv_3x3-0'),
    #                ('layer-18.CONCAT-0', 'layer-19.avg_pool_3x3-0'), ('layer-18.CONCAT-0', 'layer-19.avg_pool_3x3-2'),
    #                ('layer-18.CONCAT-0', 'layer-19.sep_conv_3x3-1'), ('layer-19.avg_pool_3x3-0', 'layer-19.ADD-0'),
    #                ('layer-19.dil_conv_3x3-0', 'layer-19.ADD-0'), ('layer-19.ADD-0', 'layer-19.avg_pool_3x3-1'),
    #                ('layer-19.ADD-0', 'layer-19.CONCAT-0'), ('layer-19.avg_pool_3x3-1', 'layer-19.ADD-1'),
    #                ('layer-19.avg_pool_3x3-2', 'layer-19.ADD-1'), ('layer-19.ADD-1', 'layer-19.avg_pool_3x3-3'),
    #                ('layer-19.ADD-1', 'layer-19.CONCAT-0'), ('layer-19.sep_conv_3x3-0', 'layer-19.ADD-2'),
    #                ('layer-19.avg_pool_3x3-3', 'layer-19.ADD-2'), ('layer-19.ADD-2', 'layer-19.avg_pool_3x3-4'),
    #                ('layer-19.ADD-2', 'layer-19.CONCAT-0'), ('layer-19.sep_conv_3x3-1', 'layer-19.ADD-3'),
    #                ('layer-19.avg_pool_3x3-4', 'layer-19.ADD-3'), ('layer-19.ADD-3', 'layer-19.CONCAT-0'),
    #                ('layer-19.CONCAT-0', 'head.adaptive_avg_pool_1x1'), ('head.adaptive_avg_pool_1x1', 'head.linear')]

    graph_edges = [['classifier.3.bias (1000)', 'AccumulateGrad-140640937860352'],
                   ['AccumulateGrad-140640937860352', 'AddmmBackward-140640937857568'],
                   ['classifier.0.bias (1024)', 'AccumulateGrad-140640932532624'],
                   ['AccumulateGrad-140640932532624', 'AddmmBackward-140640932533632'],
                   [' (2, 3, 224, 224)', 'AccumulateGrad-140640932507712'],
                   ['AccumulateGrad-140640932507712', 'ConvolutionBackward-140640932508384'],
                   ['features.0.0.weight (16, 3, 3, 3)', 'AccumulateGrad-140640932634576'],
                   ['AccumulateGrad-140640932634576', 'ConvolutionBackward-140640932508384'],
                   ['ConvolutionBackward-140640932508384', 'NativeBatchNormBackward-140640932508528'],
                   ['features.0.1.weight (16)', 'AccumulateGrad-140640932508336'],
                   ['AccumulateGrad-140640932508336', 'NativeBatchNormBackward-140640932508528'],
                   ['features.0.1.bias (16)', 'AccumulateGrad-140640932508096'],
                   ['AccumulateGrad-140640932508096', 'NativeBatchNormBackward-140640932508528'],
                   ['NativeBatchNormBackward-140640932508528', 'HardswishBackward-140640932508768'],
                   ['HardswishBackward-140640932508768', 'ConvolutionBackward-140640932509056'],
                   ['features.1.block.0.0.weight (16, 1, 3, 3)', 'AccumulateGrad-140640932508720'],
                   ['AccumulateGrad-140640932508720', 'ConvolutionBackward-140640932509056'],
                   ['ConvolutionBackward-140640932509056', 'NativeBatchNormBackward-140640932509296'],
                   ['features.1.block.0.1.weight (16)', 'AccumulateGrad-140640932509008'],
                   ['AccumulateGrad-140640932509008', 'NativeBatchNormBackward-140640932509296'],
                   ['features.1.block.0.1.bias (16)', 'AccumulateGrad-140640932508960'],
                   ['AccumulateGrad-140640932508960', 'NativeBatchNormBackward-140640932509296'],
                   ['NativeBatchNormBackward-140640932509296', 'ReluBackward-140640932510496'],
                   ['ReluBackward-140640932510496', 'MeanBackward1-140640932509680'],
                   ['MeanBackward1-140640932509680', 'ConvolutionBackward-140640932509776'],
                   ['features.1.block.1.fc1.weight (8, 16, 1, 1)', 'AccumulateGrad-140640932509536'],
                   ['AccumulateGrad-140640932509536', 'ConvolutionBackward-140640932509776'],
                   ['features.1.block.1.fc1.bias (8)', 'AccumulateGrad-140640932509440'],
                   ['AccumulateGrad-140640932509440', 'ConvolutionBackward-140640932509776'],
                   ['ConvolutionBackward-140640932509776', 'ReluBackward-140640932510064'],
                   ['ReluBackward-140640932510064', 'ConvolutionBackward-140640932510304'],
                   ['features.1.block.1.fc2.weight (16, 8, 1, 1)', 'AccumulateGrad-140640932510016'],
                   ['AccumulateGrad-140640932510016', 'ConvolutionBackward-140640932510304'],
                   ['features.1.block.1.fc2.bias (16)', 'AccumulateGrad-140640932509920'],
                   ['AccumulateGrad-140640932509920', 'ConvolutionBackward-140640932510304'],
                   ['ConvolutionBackward-140640932510304', 'HardsigmoidBackward-140640932510592'],
                   ['HardsigmoidBackward-140640932510592', 'MulBackward-140640932510736'],
                   ['ReluBackward-140640932510496', 'MulBackward-140640932510736'],
                   ['MulBackward-140640932510736', 'ConvolutionBackward-140640932511072'],
                   ['features.1.block.2.0.weight (16, 16, 1, 1)', 'AccumulateGrad-140640932510688'],
                   ['AccumulateGrad-140640932510688', 'ConvolutionBackward-140640932511072'],
                   ['ConvolutionBackward-140640932511072', 'NativeBatchNormBackward-140640932511360'],
                   ['features.1.block.2.1.weight (16)', 'AccumulateGrad-140640932510976'],
                   ['AccumulateGrad-140640932510976', 'NativeBatchNormBackward-140640932511360'],
                   ['features.1.block.2.1.bias (16)', 'AccumulateGrad-140640932510928'],
                   ['AccumulateGrad-140640932510928', 'NativeBatchNormBackward-140640932511360'],
                   ['NativeBatchNormBackward-140640932511360', 'ConvolutionBackward-140640932511648'],
                   ['features.2.block.0.0.weight (72, 16, 1, 1)', 'AccumulateGrad-140640932511168'],
                   ['AccumulateGrad-140640932511168', 'ConvolutionBackward-140640932511648'],
                   ['ConvolutionBackward-140640932511648', 'NativeBatchNormBackward-140640869331056'],
                   ['features.2.block.0.1.weight (72)', 'AccumulateGrad-140640932511600'],
                   ['AccumulateGrad-140640932511600', 'NativeBatchNormBackward-140640869331056'],
                   ['features.2.block.0.1.bias (72)', 'AccumulateGrad-140640932511504'],
                   ['AccumulateGrad-140640932511504', 'NativeBatchNormBackward-140640869331056'],
                   ['NativeBatchNormBackward-140640869331056', 'ReluBackward-140640869331392'],
                   ['ReluBackward-140640869331392', 'ConvolutionBackward-140640869331776'],
                   ['features.2.block.1.0.weight (72, 1, 3, 3)', 'AccumulateGrad-140640869331200'],
                   ['AccumulateGrad-140640869331200', 'ConvolutionBackward-140640869331776'],
                   ['ConvolutionBackward-140640869331776', 'NativeBatchNormBackward-140640869331920'],
                   ['features.2.block.1.1.weight (72)', 'AccumulateGrad-140640869331728'],
                   ['AccumulateGrad-140640869331728', 'NativeBatchNormBackward-140640869331920'],
                   ['features.2.block.1.1.bias (72)', 'AccumulateGrad-140640869331584'],
                   ['AccumulateGrad-140640869331584', 'NativeBatchNormBackward-140640869331920'],
                   ['NativeBatchNormBackward-140640869331920', 'ReluBackward-140640869332208'],
                   ['ReluBackward-140640869332208', 'ConvolutionBackward-140640869332736'],
                   ['features.2.block.2.0.weight (24, 72, 1, 1)', 'AccumulateGrad-140640869332016'],
                   ['AccumulateGrad-140640869332016', 'ConvolutionBackward-140640869332736'],
                   ['ConvolutionBackward-140640869332736', 'NativeBatchNormBackward-140640869334896'],
                   ['features.2.block.2.1.weight (24)', 'AccumulateGrad-140640869332688'],
                   ['AccumulateGrad-140640869332688', 'NativeBatchNormBackward-140640869334896'],
                   ['features.2.block.2.1.bias (24)', 'AccumulateGrad-140640869332640'],
                   ['AccumulateGrad-140640869332640', 'NativeBatchNormBackward-140640869334896'],
                   ['NativeBatchNormBackward-140640869334896', 'ConvolutionBackward-140640869333216'],
                   ['features.3.block.0.0.weight (88, 24, 1, 1)', 'AccumulateGrad-140640869332880'],
                   ['AccumulateGrad-140640869332880', 'ConvolutionBackward-140640869333216'],
                   ['ConvolutionBackward-140640869333216', 'NativeBatchNormBackward-140640869333408'],
                   ['features.3.block.0.1.weight (88)', 'AccumulateGrad-140640869333168'],
                   ['AccumulateGrad-140640869333168', 'NativeBatchNormBackward-140640869333408'],
                   ['features.3.block.0.1.bias (88)', 'AccumulateGrad-140640869333024'],
                   ['AccumulateGrad-140640869333024', 'NativeBatchNormBackward-140640869333408'],
                   ['NativeBatchNormBackward-140640869333408', 'ReluBackward-140640869333648'],
                   ['ReluBackward-140640869333648', 'ConvolutionBackward-140640869333888'],
                   ['features.3.block.1.0.weight (88, 1, 3, 3)', 'AccumulateGrad-140640869333552'],
                   ['AccumulateGrad-140640869333552', 'ConvolutionBackward-140640869333888'],
                   ['ConvolutionBackward-140640869333888', 'NativeBatchNormBackward-140640869333984'],
                   ['features.3.block.1.1.weight (88)', 'AccumulateGrad-140640869333840'],
                   ['AccumulateGrad-140640869333840', 'NativeBatchNormBackward-140640869333984'],
                   ['features.3.block.1.1.bias (88)', 'AccumulateGrad-140640869333744'],
                   ['AccumulateGrad-140640869333744', 'NativeBatchNormBackward-140640869333984'],
                   ['NativeBatchNormBackward-140640869333984', 'ReluBackward-140640869334320'],
                   ['ReluBackward-140640869334320', 'ConvolutionBackward-140640869334752'],
                   ['features.3.block.2.0.weight (24, 88, 1, 1)', 'AccumulateGrad-140640869334272'],
                   ['AccumulateGrad-140640869334272', 'ConvolutionBackward-140640869334752'],
                   ['ConvolutionBackward-140640869334752', 'NativeBatchNormBackward-140640869334992'],
                   ['features.3.block.2.1.weight (24)', 'AccumulateGrad-140640869334560'],
                   ['AccumulateGrad-140640869334560', 'NativeBatchNormBackward-140640869334992'],
                   ['features.3.block.2.1.bias (24)', 'AccumulateGrad-140640869334464'],
                   ['AccumulateGrad-140640869334464', 'NativeBatchNormBackward-140640869334992'],
                   ['NativeBatchNormBackward-140640869334992', 'AddBackward-140640993850512'],
                   ['NativeBatchNormBackward-140640869334896', 'AddBackward-140640993850512'],
                   ['AddBackward-140640993850512', 'ConvolutionBackward-140640972132752'],
                   ['features.4.block.0.0.weight (96, 24, 1, 1)', 'AccumulateGrad-140640869332256'],
                   ['AccumulateGrad-140640869332256', 'ConvolutionBackward-140640972132752'],
                   ['ConvolutionBackward-140640972132752', 'NativeBatchNormBackward-140640972132992'],
                   ['features.4.block.0.1.weight (96)', 'AccumulateGrad-140640972132656'],
                   ['AccumulateGrad-140640972132656', 'NativeBatchNormBackward-140640972132992'],
                   ['features.4.block.0.1.bias (96)', 'AccumulateGrad-140640972132416'],
                   ['AccumulateGrad-140640972132416', 'NativeBatchNormBackward-140640972132992'],
                   ['NativeBatchNormBackward-140640972132992', 'HardswishBackward-140640972133424'],
                   ['HardswishBackward-140640972133424', 'ConvolutionBackward-140640972133952'],
                   ['features.4.block.1.0.weight (96, 1, 5, 5)', 'AccumulateGrad-140640972133280'],
                   ['AccumulateGrad-140640972133280', 'ConvolutionBackward-140640972133952'],
                   ['ConvolutionBackward-140640972133952', 'NativeBatchNormBackward-140640972134240'],
                   ['features.4.block.1.1.weight (96)', 'AccumulateGrad-140640972133856'],
                   ['AccumulateGrad-140640972133856', 'NativeBatchNormBackward-140640972134240'],
                   ['features.4.block.1.1.bias (96)', 'AccumulateGrad-140640972133712'],
                   ['AccumulateGrad-140640972133712', 'NativeBatchNormBackward-140640972134240'],
                   ['NativeBatchNormBackward-140640972134240', 'HardswishBackward-140640972136016'],
                   ['HardswishBackward-140640972136016', 'MeanBackward1-140640972134960'],
                   ['MeanBackward1-140640972134960', 'ConvolutionBackward-140640972135392'],
                   ['features.4.block.2.fc1.weight (24, 96, 1, 1)', 'AccumulateGrad-140640972134816'],
                   ['AccumulateGrad-140640972134816', 'ConvolutionBackward-140640972135392'],
                   ['features.4.block.2.fc1.bias (24)', 'AccumulateGrad-140640972134624'],
                   ['AccumulateGrad-140640972134624', 'ConvolutionBackward-140640972135392'],
                   ['ConvolutionBackward-140640972135392', 'ReluBackward-140640972136112'],
                   ['ReluBackward-140640972136112', 'ConvolutionBackward-140640972136352'],
                   ['features.4.block.2.fc2.weight (96, 24, 1, 1)', 'AccumulateGrad-140640972136064'],
                   ['AccumulateGrad-140640972136064', 'ConvolutionBackward-140640972136352'],
                   ['features.4.block.2.fc2.bias (96)', 'AccumulateGrad-140640972135968'],
                   ['AccumulateGrad-140640972135968', 'ConvolutionBackward-140640972136352'],
                   ['ConvolutionBackward-140640972136352', 'HardsigmoidBackward-140640972135920'],
                   ['HardsigmoidBackward-140640972135920', 'MulBackward-140640972135872'],
                   ['HardswishBackward-140640972136016', 'MulBackward-140640972135872'],
                   ['MulBackward-140640972135872', 'ConvolutionBackward-140640972136208'],
                   ['features.4.block.3.0.weight (40, 96, 1, 1)', 'AccumulateGrad-140640972136304'],
                   ['AccumulateGrad-140640972136304', 'ConvolutionBackward-140640972136208'],
                   ['ConvolutionBackward-140640972136208', 'NativeBatchNormBackward-140640972133808'],
                   ['features.4.block.3.1.weight (40)', 'AccumulateGrad-140640972136256'],
                   ['AccumulateGrad-140640972136256', 'NativeBatchNormBackward-140640972133808'],
                   ['features.4.block.3.1.bias (40)', 'AccumulateGrad-140640972135584'],
                   ['AccumulateGrad-140640972135584', 'NativeBatchNormBackward-140640972133808'],
                   ['NativeBatchNormBackward-140640972133808', 'ConvolutionBackward-140640972135488'],
                   ['features.5.block.0.0.weight (240, 40, 1, 1)', 'AccumulateGrad-140640972135680'],
                   ['AccumulateGrad-140640972135680', 'ConvolutionBackward-140640972135488'],
                   ['ConvolutionBackward-140640972135488', 'NativeBatchNormBackward-140640972134912'],
                   ['features.5.block.0.1.weight (240)', 'AccumulateGrad-140640972135008'],
                   ['AccumulateGrad-140640972135008', 'NativeBatchNormBackward-140640972134912'],
                   ['features.5.block.0.1.bias (240)', 'AccumulateGrad-140640972135152'],
                   ['AccumulateGrad-140640972135152', 'NativeBatchNormBackward-140640972134912'],
                   ['NativeBatchNormBackward-140640972134912', 'HardswishBackward-140640972135344'],
                   ['HardswishBackward-140640972135344', 'ConvolutionBackward-140640972134336'],
                   ['features.5.block.1.0.weight (240, 1, 5, 5)', 'AccumulateGrad-140640972135440'],
                   ['AccumulateGrad-140640972135440', 'ConvolutionBackward-140640972134336'],
                   ['ConvolutionBackward-140640972134336', 'NativeBatchNormBackward-140640972134144'],
                   ['features.5.block.1.1.weight (240)', 'AccumulateGrad-140640972136400'],
                   ['AccumulateGrad-140640972136400', 'NativeBatchNormBackward-140640972134144'],
                   ['features.5.block.1.1.bias (240)', 'AccumulateGrad-140640972134864'],
                   ['AccumulateGrad-140640972134864', 'NativeBatchNormBackward-140640972134144'],
                   ['NativeBatchNormBackward-140640972134144', 'HardswishBackward-140640972133088'],
                   ['HardswishBackward-140640972133088', 'MeanBackward1-140640972134576'],
                   ['MeanBackward1-140640972134576', 'ConvolutionBackward-140640972134384'],
                   ['features.5.block.2.fc1.weight (64, 240, 1, 1)', 'AccumulateGrad-140640972133904'],
                   ['AccumulateGrad-140640972133904', 'ConvolutionBackward-140640972134384'],
                   ['features.5.block.2.fc1.bias (64)', 'AccumulateGrad-140640972134096'],
                   ['AccumulateGrad-140640972134096', 'ConvolutionBackward-140640972134384'],
                   ['ConvolutionBackward-140640972134384', 'ReluBackward-140640972133376'],
                   ['ReluBackward-140640972133376', 'ConvolutionBackward-140640972133760'],
                   ['features.5.block.2.fc2.weight (240, 64, 1, 1)', 'AccumulateGrad-140640972133520'],
                   ['AccumulateGrad-140640972133520', 'ConvolutionBackward-140640972133760'],
                   ['features.5.block.2.fc2.bias (240)', 'AccumulateGrad-140640972135536'],
                   ['AccumulateGrad-140640972135536', 'ConvolutionBackward-140640972133760'],
                   ['ConvolutionBackward-140640972133760', 'HardsigmoidBackward-140640972132944'],
                   ['HardsigmoidBackward-140640972132944', 'MulBackward-140640972133568'],
                   ['HardswishBackward-140640972133088', 'MulBackward-140640972133568'],
                   ['MulBackward-140640972133568', 'ConvolutionBackward-140640972132512'],
                   ['features.5.block.3.0.weight (40, 240, 1, 1)', 'AccumulateGrad-140640972133616'],
                   ['AccumulateGrad-140640972133616', 'ConvolutionBackward-140640972132512'],
                   ['ConvolutionBackward-140640972132512', 'NativeBatchNormBackward-140640972132800'],
                   ['features.5.block.3.1.weight (40)', 'AccumulateGrad-140640972132608'],
                   ['AccumulateGrad-140640972132608', 'NativeBatchNormBackward-140640972132800'],
                   ['features.5.block.3.1.bias (40)', 'AccumulateGrad-140640972132704'],
                   ['AccumulateGrad-140640972132704', 'NativeBatchNormBackward-140640972132800'],
                   ['NativeBatchNormBackward-140640972132800', 'AddBackward-140640931770224'],
                   ['NativeBatchNormBackward-140640972133808', 'AddBackward-140640931770224'],
                   ['AddBackward-140640931770224', 'ConvolutionBackward-140640931766624'],
                   ['features.6.block.0.0.weight (240, 40, 1, 1)', 'AccumulateGrad-140640972132560'],
                   ['AccumulateGrad-140640972132560', 'ConvolutionBackward-140640931766624'],
                   ['ConvolutionBackward-140640931766624', 'NativeBatchNormBackward-140640931766864'],
                   ['features.6.block.0.1.weight (240)', 'AccumulateGrad-140640931766576'],
                   ['AccumulateGrad-140640931766576', 'NativeBatchNormBackward-140640931766864'],
                   ['features.6.block.0.1.bias (240)', 'AccumulateGrad-140640931766480'],
                   ['AccumulateGrad-140640931766480', 'NativeBatchNormBackward-140640931766864'],
                   ['NativeBatchNormBackward-140640931766864', 'HardswishBackward-140640931767248'],
                   ['HardswishBackward-140640931767248', 'ConvolutionBackward-140640931767632'],
                   ['features.6.block.1.0.weight (240, 1, 5, 5)', 'AccumulateGrad-140640931767152'],
                   ['AccumulateGrad-140640931767152', 'ConvolutionBackward-140640931767632'],
                   ['ConvolutionBackward-140640931767632', 'NativeBatchNormBackward-140640931767776'],
                   ['features.6.block.1.1.weight (240)', 'AccumulateGrad-140640931767440'],
                   ['AccumulateGrad-140640931767440', 'NativeBatchNormBackward-140640931767776'],
                   ['features.6.block.1.1.bias (240)', 'AccumulateGrad-140640931767392'],
                   ['AccumulateGrad-140640931767392', 'NativeBatchNormBackward-140640931767776'],
                   ['NativeBatchNormBackward-140640931767776', 'HardswishBackward-140640931769456'],
                   ['HardswishBackward-140640931769456', 'MeanBackward1-140640931768448'],
                   ['MeanBackward1-140640931768448', 'ConvolutionBackward-140640931768736'],
                   ['features.6.block.2.fc1.weight (64, 240, 1, 1)', 'AccumulateGrad-140640931768256'],
                   ['AccumulateGrad-140640931768256', 'ConvolutionBackward-140640931768736'],
                   ['features.6.block.2.fc1.bias (64)', 'AccumulateGrad-140640931768112'],
                   ['AccumulateGrad-140640931768112', 'ConvolutionBackward-140640931768736'],
                   ['ConvolutionBackward-140640931768736', 'ReluBackward-140640931769024'],
                   ['ReluBackward-140640931769024', 'ConvolutionBackward-140640931769216'],
                   ['features.6.block.2.fc2.weight (240, 64, 1, 1)', 'AccumulateGrad-140640931768928'],
                   ['AccumulateGrad-140640931768928', 'ConvolutionBackward-140640931769216'],
                   ['features.6.block.2.fc2.bias (240)', 'AccumulateGrad-140640931768832'],
                   ['AccumulateGrad-140640931768832', 'ConvolutionBackward-140640931769216'],
                   ['ConvolutionBackward-140640931769216', 'HardsigmoidBackward-140640931769552'],
                   ['HardsigmoidBackward-140640931769552', 'MulBackward-140640931769744'],
                   ['HardswishBackward-140640931769456', 'MulBackward-140640931769744'],
                   ['MulBackward-140640931769744', 'ConvolutionBackward-140640931769984'],
                   ['features.6.block.3.0.weight (40, 240, 1, 1)', 'AccumulateGrad-140640931769648'],
                   ['AccumulateGrad-140640931769648', 'ConvolutionBackward-140640931769984'],
                   ['ConvolutionBackward-140640931769984', 'NativeBatchNormBackward-140640931770272'],
                   ['features.6.block.3.1.weight (40)', 'AccumulateGrad-140640931769936'],
                   ['AccumulateGrad-140640931769936', 'NativeBatchNormBackward-140640931770272'],
                   ['features.6.block.3.1.bias (40)', 'AccumulateGrad-140640931769840'],
                   ['AccumulateGrad-140640931769840', 'NativeBatchNormBackward-140640931770272'],
                   ['NativeBatchNormBackward-140640931770272', 'AddBackward-140640931766336'],
                   ['AddBackward-140640931770224', 'AddBackward-140640931766336'],
                   ['AddBackward-140640931766336', 'ConvolutionBackward-140640971710720'],
                   ['features.7.block.0.0.weight (120, 40, 1, 1)', 'AccumulateGrad-140640931767584'],
                   ['AccumulateGrad-140640931767584', 'ConvolutionBackward-140640971710720'],
                   ['ConvolutionBackward-140640971710720', 'NativeBatchNormBackward-140640971711248'],
                   ['features.7.block.0.1.weight (120)', 'AccumulateGrad-140640931768304'],
                   ['AccumulateGrad-140640931768304', 'NativeBatchNormBackward-140640971711248'],
                   ['features.7.block.0.1.bias (120)', 'AccumulateGrad-140640931768544'],
                   ['AccumulateGrad-140640931768544', 'NativeBatchNormBackward-140640971711248'],
                   ['NativeBatchNormBackward-140640971711248', 'HardswishBackward-140640971711680'],
                   ['HardswishBackward-140640971711680', 'ConvolutionBackward-140640971712256'],
                   ['features.7.block.1.0.weight (120, 1, 5, 5)', 'AccumulateGrad-140640971711536'],
                   ['AccumulateGrad-140640971711536', 'ConvolutionBackward-140640971712256'],
                   ['ConvolutionBackward-140640971712256', 'NativeBatchNormBackward-140640971712640'],
                   ['features.7.block.1.1.weight (120)', 'AccumulateGrad-140640971711968'],
                   ['AccumulateGrad-140640971711968', 'NativeBatchNormBackward-140640971712640'],
                   ['features.7.block.1.1.bias (120)', 'AccumulateGrad-140640971711776'],
                   ['AccumulateGrad-140640971711776', 'NativeBatchNormBackward-140640971712640'],
                   ['NativeBatchNormBackward-140640971712640', 'HardswishBackward-140640971714176'],
                   ['HardswishBackward-140640971714176', 'MeanBackward1-140640971713216'],
                   ['MeanBackward1-140640971713216', 'ConvolutionBackward-140640971713360'],
                   ['features.7.block.2.fc1.weight (32, 120, 1, 1)', 'AccumulateGrad-140640971713072'],
                   ['AccumulateGrad-140640971713072', 'ConvolutionBackward-140640971713360'],
                   ['features.7.block.2.fc1.bias (32)', 'AccumulateGrad-140640971712928'],
                   ['AccumulateGrad-140640971712928', 'ConvolutionBackward-140640971713360'],
                   ['ConvolutionBackward-140640971713360', 'ReluBackward-140640971713840'],
                   ['ReluBackward-140640971713840', 'ConvolutionBackward-140640971714080'],
                   ['features.7.block.2.fc2.weight (120, 32, 1, 1)', 'AccumulateGrad-140640971713696'],
                   ['AccumulateGrad-140640971713696', 'ConvolutionBackward-140640971714080'],
                   ['features.7.block.2.fc2.bias (120)', 'AccumulateGrad-140640971713504'],
                   ['AccumulateGrad-140640971713504', 'ConvolutionBackward-140640971714080'],
                   ['ConvolutionBackward-140640971714080', 'HardsigmoidBackward-140640971714368'],
                   ['HardsigmoidBackward-140640971714368', 'MulBackward-140640971711440'],
                   ['HardswishBackward-140640971714176', 'MulBackward-140640971711440'],
                   ['MulBackward-140640971711440', 'ConvolutionBackward-140640971713168'],
                   ['features.7.block.3.0.weight (48, 120, 1, 1)', 'AccumulateGrad-140640971714512'],
                   ['AccumulateGrad-140640971714512', 'ConvolutionBackward-140640971713168'],
                   ['ConvolutionBackward-140640971713168', 'NativeBatchNormBackward-140640947661264'],
                   ['features.7.block.3.1.weight (48)', 'AccumulateGrad-140640971712304'],
                   ['AccumulateGrad-140640971712304', 'NativeBatchNormBackward-140640947661264'],
                   ['features.7.block.3.1.bias (48)', 'AccumulateGrad-140640971714224'],
                   ['AccumulateGrad-140640971714224', 'NativeBatchNormBackward-140640947661264'],
                   ['NativeBatchNormBackward-140640947661264', 'ConvolutionBackward-140640947660160'],
                   ['features.8.block.0.0.weight (144, 48, 1, 1)', 'AccumulateGrad-140640947659296'],
                   ['AccumulateGrad-140640947659296', 'ConvolutionBackward-140640947660160'],
                   ['ConvolutionBackward-140640947660160', 'NativeBatchNormBackward-140640947661168'],
                   ['features.8.block.0.1.weight (144)', 'AccumulateGrad-140640947659872'],
                   ['AccumulateGrad-140640947659872', 'NativeBatchNormBackward-140640947661168'],
                   ['features.8.block.0.1.bias (144)', 'AccumulateGrad-140640947659488'],
                   ['AccumulateGrad-140640947659488', 'NativeBatchNormBackward-140640947661168'],
                   ['NativeBatchNormBackward-140640947661168', 'HardswishBackward-140640947662272'],
                   ['HardswishBackward-140640947662272', 'ConvolutionBackward-140640947662704'],
                   ['features.8.block.1.0.weight (144, 1, 5, 5)', 'AccumulateGrad-140640947662224'],
                   ['AccumulateGrad-140640947662224', 'ConvolutionBackward-140640947662704'],
                   ['ConvolutionBackward-140640947662704', 'NativeBatchNormBackward-140640947660112'],
                   ['features.8.block.1.1.weight (144)', 'AccumulateGrad-140640947662608'],
                   ['AccumulateGrad-140640947662608', 'NativeBatchNormBackward-140640947660112'],
                   ['features.8.block.1.1.bias (144)', 'AccumulateGrad-140640947662464'],
                   ['AccumulateGrad-140640947662464', 'NativeBatchNormBackward-140640947660112'],
                   ['NativeBatchNormBackward-140640947660112', 'HardswishBackward-140640947662320'],
                   ['HardswishBackward-140640947662320', 'MeanBackward1-140640947661936'],
                   ['MeanBackward1-140640947661936', 'ConvolutionBackward-140640947660832'],
                   ['features.8.block.2.fc1.weight (40, 144, 1, 1)', 'AccumulateGrad-140640947661312'],
                   ['AccumulateGrad-140640947661312', 'ConvolutionBackward-140640947660832'],
                   ['features.8.block.2.fc1.bias (40)', 'AccumulateGrad-140640947660544'],
                   ['AccumulateGrad-140640947660544', 'ConvolutionBackward-140640947660832'],
                   ['ConvolutionBackward-140640947660832', 'ReluBackward-140640947661600'],
                   ['ReluBackward-140640947661600', 'ConvolutionBackward-140640947662752'],
                   ['features.8.block.2.fc2.weight (144, 40, 1, 1)', 'AccumulateGrad-140640947661840'],
                   ['AccumulateGrad-140640947661840', 'ConvolutionBackward-140640947662752'],
                   ['features.8.block.2.fc2.bias (144)', 'AccumulateGrad-140640947660880'],
                   ['AccumulateGrad-140640947660880', 'ConvolutionBackward-140640947662752'],
                   ['ConvolutionBackward-140640947662752', 'HardsigmoidBackward-140640947662416'],
                   ['HardsigmoidBackward-140640947662416', 'MulBackward-140640947661888'],
                   ['HardswishBackward-140640947662320', 'MulBackward-140640947661888'],
                   ['MulBackward-140640947661888', 'ConvolutionBackward-140640947662128'],
                   ['features.8.block.3.0.weight (48, 144, 1, 1)', 'AccumulateGrad-140640947662080'],
                   ['AccumulateGrad-140640947662080', 'ConvolutionBackward-140640947662128'],
                   ['ConvolutionBackward-140640947662128', 'NativeBatchNormBackward-140640947661120'],
                   ['features.8.block.3.1.weight (48)', 'AccumulateGrad-140640947662800'],
                   ['AccumulateGrad-140640947662800', 'NativeBatchNormBackward-140640947661120'],
                   ['features.8.block.3.1.bias (48)', 'AccumulateGrad-140640947659584'],
                   ['AccumulateGrad-140640947659584', 'NativeBatchNormBackward-140640947661120'],
                   ['NativeBatchNormBackward-140640947661120', 'AddBackward-140640947661024'],
                   ['NativeBatchNormBackward-140640947661264', 'AddBackward-140640947661024'],
                   ['AddBackward-140640947661024', 'ConvolutionBackward-140640947661504'],
                   ['features.9.block.0.0.weight (288, 48, 1, 1)', 'AccumulateGrad-140640947661216'],
                   ['AccumulateGrad-140640947661216', 'ConvolutionBackward-140640947661504'],
                   ['ConvolutionBackward-140640947661504', 'NativeBatchNormBackward-140640947660256'],
                   ['features.9.block.0.1.weight (288)', 'AccumulateGrad-140640947661552'],
                   ['AccumulateGrad-140640947661552', 'NativeBatchNormBackward-140640947660256'],
                   ['features.9.block.0.1.bias (288)', 'AccumulateGrad-140640947661648'],
                   ['AccumulateGrad-140640947661648', 'NativeBatchNormBackward-140640947660256'],
                   ['NativeBatchNormBackward-140640947660256', 'HardswishBackward-140640947660688'],
                   ['HardswishBackward-140640947660688', 'ConvolutionBackward-140640947660592'],
                   ['features.9.block.1.0.weight (288, 1, 5, 5)', 'AccumulateGrad-140640947659968'],
                   ['AccumulateGrad-140640947659968', 'ConvolutionBackward-140640947660592'],
                   ['ConvolutionBackward-140640947660592', 'NativeBatchNormBackward-140640947660400'],
                   ['features.9.block.1.1.weight (288)', 'AccumulateGrad-140640947659776'],
                   ['AccumulateGrad-140640947659776', 'NativeBatchNormBackward-140640947660400'],
                   ['features.9.block.1.1.bias (288)', 'AccumulateGrad-140640947659920'],
                   ['AccumulateGrad-140640947659920', 'NativeBatchNormBackward-140640947660400'],
                   ['NativeBatchNormBackward-140640947660400', 'HardswishBackward-140640947661984'],
                   ['HardswishBackward-140640947661984', 'MeanBackward1-140640947659008'],
                   ['MeanBackward1-140640947659008', 'ConvolutionBackward-140640947659056'],
                   ['features.9.block.2.fc1.weight (72, 288, 1, 1)', 'AccumulateGrad-140640947659104'],
                   ['AccumulateGrad-140640947659104', 'ConvolutionBackward-140640947659056'],
                   ['features.9.block.2.fc1.bias (72)', 'AccumulateGrad-140640947659248'],
                   ['AccumulateGrad-140640947659248', 'ConvolutionBackward-140640947659056'],
                   ['ConvolutionBackward-140640947659056', 'ReluBackward-140640947659392'],
                   ['ReluBackward-140640947659392', 'ConvolutionBackward-140640947658864'],
                   ['features.9.block.2.fc2.weight (288, 72, 1, 1)', 'AccumulateGrad-140640947659536'],
                   ['AccumulateGrad-140640947659536', 'ConvolutionBackward-140640947658864'],
                   ['features.9.block.2.fc2.bias (288)', 'AccumulateGrad-140640947658816'],
                   ['AccumulateGrad-140640947658816', 'ConvolutionBackward-140640947658864'],
                   ['ConvolutionBackward-140640947658864', 'HardsigmoidBackward-140640947659728'],
                   ['HardsigmoidBackward-140640947659728', 'MulBackward-140640869413024'],
                   ['HardswishBackward-140640947661984', 'MulBackward-140640869413024'],
                   ['MulBackward-140640869413024', 'ConvolutionBackward-140640869414704'],
                   ['features.9.block.3.0.weight (96, 288, 1, 1)', 'AccumulateGrad-140640947660928'],
                   ['AccumulateGrad-140640947660928', 'ConvolutionBackward-140640869414704'],
                   ['ConvolutionBackward-140640869414704', 'NativeBatchNormBackward-140640991968704'],
                   ['features.9.block.3.1.weight (96)', 'AccumulateGrad-140640869414080'],
                   ['AccumulateGrad-140640869414080', 'NativeBatchNormBackward-140640991968704'],
                   ['features.9.block.3.1.bias (96)', 'AccumulateGrad-140640869413984'],
                   ['AccumulateGrad-140640869413984', 'NativeBatchNormBackward-140640991968704'],
                   ['NativeBatchNormBackward-140640991968704', 'ConvolutionBackward-140640869416864'],
                   ['features.10.block.0.0.weight (576, 96, 1, 1)', 'AccumulateGrad-140640869415088'],
                   ['AccumulateGrad-140640869415088', 'ConvolutionBackward-140640869416864'],
                   ['ConvolutionBackward-140640869416864', 'NativeBatchNormBackward-140640869415520'],
                   ['features.10.block.0.1.weight (576)', 'AccumulateGrad-140640869416768'],
                   ['AccumulateGrad-140640869416768', 'NativeBatchNormBackward-140640869415520'],
                   ['features.10.block.0.1.bias (576)', 'AccumulateGrad-140640869416048'],
                   ['AccumulateGrad-140640869416048', 'NativeBatchNormBackward-140640869415520'],
                   ['NativeBatchNormBackward-140640869415520', 'HardswishBackward-140640869416240'],
                   ['HardswishBackward-140640869416240', 'ConvolutionBackward-140640869416576'],
                   ['features.10.block.1.0.weight (576, 1, 5, 5)', 'AccumulateGrad-140640869416432'],
                   ['AccumulateGrad-140640869416432', 'ConvolutionBackward-140640869416576'],
                   ['ConvolutionBackward-140640869416576', 'NativeBatchNormBackward-140640869415280'],
                   ['features.10.block.1.1.weight (576)', 'AccumulateGrad-140640869416480'],
                   ['AccumulateGrad-140640869416480', 'NativeBatchNormBackward-140640869415280'],
                   ['features.10.block.1.1.bias (576)', 'AccumulateGrad-140640869416672'],
                   ['AccumulateGrad-140640869416672', 'NativeBatchNormBackward-140640869415280'],
                   ['NativeBatchNormBackward-140640869415280', 'HardswishBackward-140640869414032'],
                   ['HardswishBackward-140640869414032', 'MeanBackward1-140640869414560'],
                   ['MeanBackward1-140640869414560', 'ConvolutionBackward-140640869415616'],
                   ['features.10.block.2.fc1.weight (144, 576, 1, 1)', 'AccumulateGrad-140640869414944'],
                   ['AccumulateGrad-140640869414944', 'ConvolutionBackward-140640869415616'],
                   ['features.10.block.2.fc1.bias (144)', 'AccumulateGrad-140640869415712'],
                   ['AccumulateGrad-140640869415712', 'ConvolutionBackward-140640869415616'],
                   ['ConvolutionBackward-140640869415616', 'ReluBackward-140640869415808'],
                   ['ReluBackward-140640869415808', 'ConvolutionBackward-140640869413504'],
                   ['features.10.block.2.fc2.weight (576, 144, 1, 1)', 'AccumulateGrad-140640869414464'],
                   ['AccumulateGrad-140640869414464', 'ConvolutionBackward-140640869413504'],
                   ['features.10.block.2.fc2.bias (576)', 'AccumulateGrad-140640869415376'],
                   ['AccumulateGrad-140640869415376', 'ConvolutionBackward-140640869413504'],
                   ['ConvolutionBackward-140640869413504', 'HardsigmoidBackward-140640869413456'],
                   ['HardsigmoidBackward-140640869413456', 'MulBackward-140640869413648'],
                   ['HardswishBackward-140640869414032', 'MulBackward-140640869413648'],
                   ['MulBackward-140640869413648', 'ConvolutionBackward-140640991966352'],
                   ['features.10.block.3.0.weight (96, 576, 1, 1)', 'AccumulateGrad-140640869413936'],
                   ['AccumulateGrad-140640869413936', 'ConvolutionBackward-140640991966352'],
                   ['ConvolutionBackward-140640991966352', 'NativeBatchNormBackward-140640869449792'],
                   ['features.10.block.3.1.weight (96)', 'AccumulateGrad-140640869414224'],
                   ['AccumulateGrad-140640869414224', 'NativeBatchNormBackward-140640869449792'],
                   ['features.10.block.3.1.bias (96)', 'AccumulateGrad-140640869415760'],
                   ['AccumulateGrad-140640869415760', 'NativeBatchNormBackward-140640869449792'],
                   ['NativeBatchNormBackward-140640869449792', 'AddBackward-140640763511040'],
                   ['NativeBatchNormBackward-140640991968704', 'AddBackward-140640763511040'],
                   ['AddBackward-140640763511040', 'ConvolutionBackward-140640869450800'],
                   ['features.11.block.0.0.weight (576, 96, 1, 1)', 'AccumulateGrad-140640869450128'],
                   ['AccumulateGrad-140640869450128', 'ConvolutionBackward-140640869450800'],
                   ['ConvolutionBackward-140640869450800', 'NativeBatchNormBackward-140640869450944'],
                   ['features.11.block.0.1.weight (576)', 'AccumulateGrad-140640869450464'],
                   ['AccumulateGrad-140640869450464', 'NativeBatchNormBackward-140640869450944'],
                   ['features.11.block.0.1.bias (576)', 'AccumulateGrad-140640869450416'],
                   ['AccumulateGrad-140640869450416', 'NativeBatchNormBackward-140640869450944'],
                   ['NativeBatchNormBackward-140640869450944', 'HardswishBackward-140640869451280'],
                   ['HardswishBackward-140640869451280', 'ConvolutionBackward-140640869451952'],
                   ['features.11.block.1.0.weight (576, 1, 5, 5)', 'AccumulateGrad-140640869451136'],
                   ['AccumulateGrad-140640869451136', 'ConvolutionBackward-140640869451952'],
                   ['ConvolutionBackward-140640869451952', 'NativeBatchNormBackward-140640869452528'],
                   ['features.11.block.1.1.weight (576)', 'AccumulateGrad-140640869451904'],
                   ['AccumulateGrad-140640869451904', 'NativeBatchNormBackward-140640869452528'],
                   ['features.11.block.1.1.bias (576)', 'AccumulateGrad-140640869451424'],
                   ['AccumulateGrad-140640869451424', 'NativeBatchNormBackward-140640869452528'],
                   ['NativeBatchNormBackward-140640869452528', 'HardswishBackward-140640869450512'],
                   ['HardswishBackward-140640869450512', 'MeanBackward1-140640869453104'],
                   ['MeanBackward1-140640869453104', 'ConvolutionBackward-140640869453200'],
                   ['features.11.block.2.fc1.weight (144, 576, 1, 1)', 'AccumulateGrad-140640869453008'],
                   ['AccumulateGrad-140640869453008', 'ConvolutionBackward-140640869453200'],
                   ['features.11.block.2.fc1.bias (144)', 'AccumulateGrad-140640869452768'],
                   ['AccumulateGrad-140640869452768', 'ConvolutionBackward-140640869453200'],
                   ['ConvolutionBackward-140640869453200', 'ReluBackward-140640869451184'],
                   ['ReluBackward-140640869451184', 'ConvolutionBackward-140640869453296'],
                   ['features.11.block.2.fc2.weight (576, 144, 1, 1)', 'AccumulateGrad-140640869453776'],
                   ['AccumulateGrad-140640869453776', 'ConvolutionBackward-140640869453296'],
                   ['features.11.block.2.fc2.bias (576)', 'AccumulateGrad-140640869453536'],
                   ['AccumulateGrad-140640869453536', 'ConvolutionBackward-140640869453296'],
                   ['ConvolutionBackward-140640869453296', 'HardsigmoidBackward-140640869453056'],
                   ['HardsigmoidBackward-140640869453056', 'MulBackward-140640869451232'],
                   ['HardswishBackward-140640869450512', 'MulBackward-140640869451232'],
                   ['MulBackward-140640869451232', 'ConvolutionBackward-140640763510896'],
                   ['features.11.block.3.0.weight (96, 576, 1, 1)', 'AccumulateGrad-140640869452864'],
                   ['AccumulateGrad-140640869452864', 'ConvolutionBackward-140640763510896'],
                   ['ConvolutionBackward-140640763510896', 'NativeBatchNormBackward-140640763511088'],
                   ['features.11.block.3.1.weight (96)', 'AccumulateGrad-140640869452480'],
                   ['AccumulateGrad-140640869452480', 'NativeBatchNormBackward-140640763511088'],
                   ['features.11.block.3.1.bias (96)', 'AccumulateGrad-140640869452240'],
                   ['AccumulateGrad-140640869452240', 'NativeBatchNormBackward-140640763511088'],
                   ['NativeBatchNormBackward-140640763511088', 'AddBackward-140640763511472'],
                   ['AddBackward-140640763511040', 'AddBackward-140640763511472'],
                   ['AddBackward-140640763511472', 'ConvolutionBackward-140640932607792'],
                   ['features.12.0.weight (576, 96, 1, 1)', 'AccumulateGrad-140640763511424'],
                   ['AccumulateGrad-140640763511424', 'ConvolutionBackward-140640932607792'],
                   ['ConvolutionBackward-140640932607792', 'NativeBatchNormBackward-140640932606256'],
                   ['features.12.1.weight (576)', 'AccumulateGrad-140640763511712'],
                   ['AccumulateGrad-140640763511712', 'NativeBatchNormBackward-140640932606256'],
                   ['features.12.1.bias (576)', 'AccumulateGrad-140640763511568'],
                   ['AccumulateGrad-140640763511568', 'NativeBatchNormBackward-140640932606256'],
                   ['NativeBatchNormBackward-140640932606256', 'HardswishBackward-140640932608080'],
                   ['HardswishBackward-140640932608080', 'MeanBackward1-140640932532336'],
                   ['MeanBackward1-140640932532336', 'ReshapeAliasBackward-140640932532288'],
                   ['ReshapeAliasBackward-140640932532288', 'AddmmBackward-140640932533632'],
                   ['classifier.0.weight (1024, 576)', 'AccumulateGrad-140640932534304'],
                   ['AccumulateGrad-140640932534304', 'TBackward-140640932535024'],
                   ['TBackward-140640932535024', 'AddmmBackward-140640932533632'],
                   ['AddmmBackward-140640932533632', 'HardswishBackward-140640932532960'],
                   ['HardswishBackward-140640932532960', 'MulBackward-140640937857136'],
                   ['MulBackward-140640937857136', 'AddmmBackward-140640937857568'],
                   ['classifier.3.weight (1000, 1024)', 'AccumulateGrad-140640932533392'],
                   ['AccumulateGrad-140640932533392', 'TBackward-140640937859824'],
                   ['TBackward-140640937859824', 'AddmmBackward-140640937857568']]

    graph_edges = remove_useless_node(graph_edges=graph_edges, node_name='AccumulateGrad')
    graph_edges = remove_useless_node(graph_edges, node_name='TBackward')
    graph = GraphAdj(graph_edges=graph_edges)
    loose_input = [graph.nodes_list[_i] for _i in np.where(graph.in_degree == 0)[0]]
    graph_edges = remove_loose_input(graph_edges, loose_input)
    graph = GraphAdj(graph_edges=graph_edges)

    type_of_nodes, node_types_idxs = encode_node_types(graph.adj_matrix)

    subseqs_0 = find_repeat_subseqs(node_types_idxs)

    lens_subseqs_0 = [len(ss) for ss in subseqs_0]

    i = 0
    subseqs_node_list = []
    for l in lens_subseqs_0:
        subseqs_node_list.append(graph.nodes_list[i:i + l])
        i += l

    for i, ssn in enumerate(subseqs_node_list):
        print('\r%03d' % i, end='')
        ss_edges_list = []
        for node_i, node_j in graph_edges:
            if node_i in ssn or node_j in ssn:
                ss_edges_list.append((node_i, node_j))
        visualize_graph(edges_list=ss_edges_list, filename='subgraph/subgraph-%03d' % i)
    print('\r%03d' % i)

if __name__ == '__main__':
    test()
